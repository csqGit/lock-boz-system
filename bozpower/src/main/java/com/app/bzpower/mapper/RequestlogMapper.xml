<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.app.bzpower.dao.RequestlogMapper">
	<resultMap id="BaseResultMap"
		type="com.app.bzpower.entity.Requestlog">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Fri Aug 23 
			11:59:05 CST 2019. -->
		<id column="id" jdbcType="INTEGER" property="id" />
		<result column="voltage" jdbcType="VARCHAR" property="voltage" />
		<result column="classes" jdbcType="VARCHAR" property="classes" />
		<result column="mac" jdbcType="VARCHAR" property="mac" />
		<result column="did" jdbcType="VARCHAR" property="did" />
		<result column="requesttime" jdbcType="VARCHAR"
			property="requesttime" />
		<result column="opentime" jdbcType="VARCHAR"
			property="opentime" />
		<result column="closeTime" jdbcType="VARCHAR"
			property="closetime" />
		<result column="status" jdbcType="INTEGER" property="status" />
		<result column="realname" jdbcType="VARCHAR"
			property="realname" />
		<result column="phone" jdbcType="VARCHAR" property="phone" />
		<result column="reason" jdbcType="VARCHAR" property="reason" />
		<result column="examineresult" jdbcType="VARCHAR"
			property="examineresult" />
		<result column="dtm" jdbcType="VARCHAR" property="dtm" />
		<result column="opennum" jdbcType="VARCHAR" property="opennum" />
		<result column="remarks" jdbcType="VARCHAR" property="remarks" />
		<association property="companyId"
			javaType="com.app.bzpower.entity.Company">
			<id column="company_id" property="id" />
			<result column="companyName" jdbcType="VARCHAR"
				property="companyname" />
			<result column="voltage" jdbcType="VARCHAR" property="voltage" />
		</association>
		<association property="adminId"
			javaType="com.app.bzpower.entity.Admin">
			<id column="admin_id" property="id" />
			<result column="username" jdbcType="VARCHAR"
				property="username" />
			<result column="realname" jdbcType="VARCHAR"
				property="realname" />
			<result column="password" jdbcType="VARCHAR"
				property="password" />
			<result column="telephone" jdbcType="VARCHAR"
				property="telephone" />
			<result column="type" jdbcType="INTEGER" property="type" />
			<result column="voltage" jdbcType="VARCHAR" property="voltage" />
		</association>
		<association property="lockinfoId"
			javaType="com.app.bzpower.entity.Lockinfo">
			<id column="lockinfo_id" property="id" />
			<result column="did" jdbcType="VARCHAR" property="did" />
			<result column="mac" jdbcType="VARCHAR" property="mac" />
			<result column="passcode" jdbcType="VARCHAR"
				property="passcode" />
			<result column="classes" jdbcType="VARCHAR" property="classes" />
			<result column="voltage" jdbcType="VARCHAR" property="voltage" />
		</association>

		<association property="transformersubId"
			javaType="com.app.bzpower.entity.TransformerSub">
			<id column="transformersub_id" property="id" />
			<result column="transformersub" jdbcType="VARCHAR"
				property="transformersub" />
			<result column="voltage" jdbcType="VARCHAR" property="voltage" />
		</association>
	</resultMap>

	<sql id="Base_Column_List">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Fri Aug 23 
			11:59:05 CST 2019. -->
		id, voltage, classes, mac, did, requesttime, opentime, closeTime,
		status, realname,
		phone, reason, examineresult, dtm, opennum, remarks, company_id, admin_id,
		lockinfo_id,
		transformersub_id
	</sql>


	<select id="selectlogList" resultMap="BaseResultMap">
		<!-- select * from requestlog r, company c where r.voltage = #{voltage} 
			and c.companyname = #{companyname} -->
		select r.id, r.voltage, r.classes, r.mac, r.did,
		r.requesttime, r.opentime, r.closeTime, r.status, r.realname,
		r.phone, r.reason, r.examineresult, r.dtm,
		r.opennum, c.companyname, a.realname, t.transformersub
		from requestlog r
		inner join company c
		on c.id = r.company_id
		inner join admin a
		on a.id = r.admin_id
		inner join lockinfo l
		on l.id = r.lockinfo_id
		inner join transformersub t
		on t.id = l.transformersub_id

		where r.voltage = #{voltage}
		and c.companyname = #{companyname}
		<if test="pageData.limit != 0">
			limit #{pageData.startPage}, #{pageData.limit}
		</if>
	</select>
	<select id="countByExample" resultType="java.lang.Long">
		select count(r.id)
		from requestlog r
		inner join company c
		on c.id = r.company_id
		inner join admin a
		on a.id = r.admin_id
		inner join lockinfo l
		on l.id = r.lockinfo_id
		inner join transformersub t
		on t.id = l.transformersub_id

		where r.voltage = #{voltage}
		and r.company_id = #{companyId.id}

	</select>


</mapper>